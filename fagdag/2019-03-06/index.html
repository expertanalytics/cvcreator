<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Chaospy -- Uncertainty Quatification</title><meta charset="UTF-8"></meta><meta name="generator" content="Hovercraft! 1.0 http://regebro.github.com/hovercraft"></meta><link rel="stylesheet" href="css/hovercraft.css" media="all"></link><link rel="stylesheet" href="css/impressConsole.css" media="all"></link><link rel="stylesheet" href="css/highlight.css" media="all"></link><script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        showProcessingMessages: false,
        messageStyle: "none",
        TeX : { extensions : ['color.js'] }
      });
    </script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script></head><body class="impress-not-supported"><div class="header"><img src="logo.jpg"></img></div><div id="impress" data-transition-duration="500"><div class="step step-level-1" step="0" data-x="1000" data-y="0" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-z="0"><h1 id="why-chaospy-is-awesome">Why Chaospy is awesome!</h1><p>For those who didn't know that from before.</p><p>By Jonathan Feinberg</p></div><div class="step step-level-1" step="1" data-x="2000" data-y="0" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-z="0"><h1 id="chaospy-is-a-library-for-doing-uncertainty-quantification">Chaospy is a library for doing Uncertainty Quantification</h1><ul><li>Mostly Advanced Monte Carlo and Polynomial Chaos Expansions.</li><li>Built upon <tt>numpy</tt> and <tt>scipy</tt>.</li><li>Think <tt>statsmodels</tt> or <tt>scikit-learn</tt>, but with a specific task at hand.</li></ul></div><div class="step step-level-1" step="2" data-x="3000" data-y="0" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-z="0"><h1 id="the-basic-building-blocks">The Basic building blocks</h1><pre class="highlight code python"><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">chaospy</span>

<span class="c1"># create a distribution:</span>
<span class="n">distribution</span> <span class="o">=</span> <span class="n">chaospy</span><span class="o">.</span><span class="n">J</span><span class="p">(</span><span class="n">chaospy</span><span class="o">.</span><span class="n">Normal</span><span class="p">(),</span> <span class="n">chaospy</span><span class="o">.</span><span class="n">Exponential</span><span class="p">())</span>

<span class="c1"># create probability density function evals and random samples:</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">evals</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span></pre></div><div class="step step-level-1" step="3" data-x="3000" data-y="800" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-z="0"><pre class="highlight code python"><span class="n">pyplot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mesh</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">evals</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">samples</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span></pre><img src="dist1.png"></img></div><div class="step step-level-1" step="4" data-x="3000" data-y="0" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-z="0"></div><div class="step step-level-1" step="5" data-x="4000" data-y="0" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-z="0"><h1 id="stochastic-dependencies">Stochastic Dependencies</h1><pre class="highlight code python"><span class="n">distribution1</span> <span class="o">=</span> <span class="n">chaospy</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">distribution2</span> <span class="o">=</span> <span class="n">chaospy</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span>
    <span class="n">lower</span><span class="o">=</span><span class="n">distribution1</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">distribution1</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">distribution</span> <span class="o">=</span> <span class="n">chaospy</span><span class="o">.</span><span class="n">J</span><span class="p">(</span><span class="n">distribution1</span><span class="p">,</span> <span class="n">distribution2</span><span class="p">)</span>

<span class="n">evals</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span></pre></div><div class="step step-level-1" step="6" data-x="4000" data-y="800" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-z="0"><pre class="highlight code python"><span class="n">pyplot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mesh</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">evals</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">samples</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span></pre><img src="dist2.png"></img></div><div class="step step-level-1" step="7" data-x="4000" data-y="0" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-z="0"></div><div class="step step-level-1" step="8" data-x="5000" data-y="0" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-z="0"><h1 id="let-s-make-a-circle">Let's make a Circle</h1><img src="circle1.png"></img></div><div class="step step-level-1" step="9" data-x="5000" data-y="800" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-z="0"><h1 id="some-math-assembly-required">Some (Math) Assembly Required</h1><p>General formulation for multivariate densities:</p><div class="math-block ">$$\begin{align}f_{X,Y}(x, y) = f_X(x) f_{Y\mid X}(y)\end{align}$$</div><p>Calculate <span class="math ">\(f_X\)</span> and its cumulative <span class="math ">\(F_X\)</span>:</p><div class="math-block ">$$\begin{align}f_X(x) = \int_{-1}^1 f_{X,Y}(x, y) dy
       = \int_{-1}^1 \frac 1\pi I_{\{x^2 + y^2 \leq 1\}} dy
       = \cdots
       = \frac 2\pi \sqrt{1-x^2}\end{align}$$</div><div class="math-block ">$$\begin{align}F_X(x) = \int_{-1}^x f_X(t) dt = \cdots = \frac{\left(\sqrt{1-x^2}x + sin^{-1}(x) \right)}\pi + \frac 12\end{align}$$</div><p>Calculate <span class="math ">\(f_{Y|X}\)</span> and <span class="math ">\(F_{Y|X}\)</span>:</p><div class="math-block ">$$\begin{align}f_{Y\mid X}(y) = \frac{f_{XY}}{f_X} = \cdots = \frac 1{2\sqrt{1-X^2}}\end{align}$$</div><div class="math-block ">$$\begin{align}F_{Y\mid X}(y) = \int_{-\sqrt{1-X^2}}^y f_{Y\mid X}(t) dt = \cdots = \frac{y-\sqrt{1-X^2}}{2\sqrt{1-X^2}}\end{align}$$</div></div><div class="step step-level-1" step="10" data-x="5000" data-y="1600" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-z="0"><h1 id="some-code-assembly-required">Some (Code) Assembly Required</h1><pre class="highlight code python"><span class="k">class</span> <span class="nc">Circle1</span><span class="p">(</span><span class="n">chaospy</span><span class="o">.</span><span class="n">Dist</span><span class="p">):</span>
    <span class="n">_bnd</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">_pdf</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">_cdf</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mf">2.</span>

<span class="k">class</span> <span class="nc">Circle2</span><span class="p">(</span><span class="n">chaospy</span><span class="o">.</span><span class="n">Dist</span><span class="p">):</span>
    <span class="n">_bnd</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
    <span class="n">_pdf</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="n">_cdf</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="n">circle1</span> <span class="o">=</span> <span class="n">Circle1</span><span class="p">()</span>
<span class="n">circle2</span> <span class="o">=</span> <span class="n">Circle2</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">circle1</span><span class="p">)</span>
<span class="n">distribution</span> <span class="o">=</span> <span class="n">chaospy</span><span class="o">.</span><span class="n">J</span><span class="p">(</span><span class="n">circle1</span><span class="p">,</span> <span class="n">circle2</span><span class="p">)</span>

<span class="n">evals</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">distribution</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span></pre></div><div class="step step-level-1" step="11" data-x="5000" data-y="2400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-z="0"><pre class="highlight code python"><span class="n">pyplot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">mesh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mesh</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">evals</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">samples</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span></pre><img src="circle2.png"></img></div><div class="step step-level-1" step="12" data-x="5000" data-y="0" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1" data-z="0"></div><div class="step step-level-1" step="13" data-x="6000" data-y="0" data-rotate-x="0" data-rotate-y="0" data-rotate-z="-90" data-scale="1" data-z="0"><h1 id="model-approximation">Model Approximation</h1><p>Toy problem (assumed to be actually complicated IRL):</p><pre class="highlight code python"><span class="n">t</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">u</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
    <span class="sd">"""My hard core function."""</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">e</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span></pre><p>Input is random assumed distributed as <tt>Circle</tt>:</p><pre class="highlight code python"><span class="n">distribution</span> <span class="o">=</span> <span class="n">chaospy</span><span class="o">.</span><span class="n">J</span><span class="p">(</span><span class="n">circle1</span><span class="p">,</span> <span class="n">circle2</span><span class="p">)</span></pre><p>What is the statistical metrics:</p><div class="math-block ">$$\begin{align}\mathbb{E}[U], Std(U), ...\end{align}$$</div></div><div class="step step-level-1" step="14" data-x="6000" data-y="-1000" data-rotate-x="0" data-rotate-y="0" data-rotate-z="-90" data-scale="1" data-z="0"><h1 id="monte-carlo-integration">Monte-Carlo Integration</h1><pre class="highlight code python"><span class="n">samples</span> <span class="o">=</span> <span class="n">circle</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">evals</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="o">.</span><span class="n">T</span><span class="p">]</span>

<span class="n">mean</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></pre></div><div class="step step-level-1" step="15" data-x="6800" data-y="-1000" data-rotate-x="0" data-rotate-y="0" data-rotate-z="-90" data-scale="1" data-z="0"><pre class="highlight code python"><span class="n">pyplot</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">mean</span><span class="o">-</span><span class="n">std</span><span class="p">,</span> <span class="n">mean</span><span class="o">+</span><span class="n">std</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"r"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="k">for</span> <span class="n">eval_</span> <span class="ow">in</span> <span class="n">evals</span><span class="p">:</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">eval_</span><span class="p">,</span> <span class="s2">"k-"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="s2">"r--"</span><span class="p">)</span></pre><img src="monte_carlo1.png"></img></div><div class="step step-level-1" step="16" data-x="6000" data-y="-1000" data-rotate-x="0" data-rotate-y="0" data-rotate-z="-90" data-scale="1" data-z="0"></div><div class="step step-level-1" step="17" data-x="6000" data-y="-2000" data-rotate-x="0" data-rotate-y="0" data-rotate-z="-90" data-scale="1" data-z="0"><h1 id="id1">Model Approximation</h1><img src="mapping.png"></img></div><div class="step step-level-1" step="18" data-x="6000" data-y="-3000" data-rotate-x="0" data-rotate-y="0" data-rotate-z="-90" data-scale="1" data-z="0"><h1 id="least-square-polynomial-fit">Least Square polynomial fit</h1><p>Approximation using polynomials</p><div class="math-block ">$$\begin{align}u \approx P(q) = \sum_{n=1}^N c_n(t) q_n(q)\end{align}$$</div><pre class="highlight code python"><span class="n">samples</span> <span class="o">=</span> <span class="n">circle</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">evals</span> <span class="o">=</span> <span class="p">[</span><span class="n">Y</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="o">.</span><span class="n">T</span><span class="p">]</span>

<span class="c1"># Polynomial basis:</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">chaospy</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="c1"># [1, q0, q1, q0^2, q0q1, q1^2, q0^3, q0^2q1, q0q1^2, q1^3]</span>

<span class="c1"># Least squares method:</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">Q</span><span class="p">(</span><span class="o">*</span><span class="n">samples</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">T</span> <span class="err">@</span> <span class="n">A</span><span class="p">)</span> <span class="err">@</span> <span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">T</span> <span class="err">@</span> <span class="n">evals</span><span class="p">)</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">chaospy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Q</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">chaospy</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">12</span><span class="p">))</span>
<span class="c1"># 2.7183q0+2.7183</span></pre></div><div class="step step-level-1" step="19" data-x="6800" data-y="-3000" data-rotate-x="0" data-rotate-y="0" data-rotate-z="-90" data-scale="1" data-z="0"><h1 id="proxy-monte-carlo">Proxy-Monte-Carlo</h1><pre class="highlight code python"><span class="n">samples</span> <span class="o">=</span> <span class="n">circle</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">evals</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="o">*</span><span class="n">samples</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

<span class="n">mean</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">mean</span><span class="o">-</span><span class="n">std</span><span class="p">,</span> <span class="n">mean</span><span class="o">+</span><span class="n">std</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"r"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="k">for</span> <span class="n">eval_</span> <span class="ow">in</span> <span class="n">evals</span><span class="o">.</span><span class="n">T</span><span class="p">:</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">eval_</span><span class="p">,</span> <span class="s2">"k-"</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="s2">"r--"</span><span class="p">)</span></pre><img src="monte_carlo2.png"></img></div><div class="step step-level-1" step="20" data-x="6800" data-y="-1000" data-rotate-x="0" data-rotate-y="0" data-rotate-z="-90" data-scale="1" data-z="0"></div><div class="step step-level-1" step="21" data-x="6800" data-y="-3000" data-rotate-x="0" data-rotate-y="0" data-rotate-z="-90" data-scale="1" data-z="0"></div><div class="step step-level-1" step="22" data-x="6000" data-y="-4000" data-rotate-x="0" data-rotate-y="0" data-rotate-z="270" data-scale="1" data-z="0"><h1 id="unsolved-problems-for-fagdag">Unsolved problems for "Fagdag"</h1></div><div class="step step-level-1" step="23" data-x="6000" data-y="-5000" data-rotate-x="0" data-rotate-y="0" data-rotate-z="270" data-scale="1" data-z="0"><h1 id="kernel-density-estimation">Kernel Density Estimation</h1><img src="kde.gif"></img></div><div class="step step-level-1" step="24" data-x="6000" data-y="-6000" data-rotate-x="0" data-rotate-y="0" data-rotate-z="270" data-scale="1" data-z="0"><h1 id="cookbook-examples">Cookbook Examples</h1><p>Lots of examples can be created for <a href="https://chaospy.readthedocs.io">Readthedocs</a></p></div><div class="step step-level-1" step="25" data-x="6000" data-y="-7000" data-rotate-x="0" data-rotate-y="0" data-rotate-z="270" data-scale="1" data-z="0"><h1 id="sparse-polynomial-representation">Sparse Polynomial Representation</h1><p>The polynomials are simple:</p><pre class="highlight code python"><span class="n">expansion</span> <span class="o">=</span> <span class="n">chaospy</span><span class="o">.</span><span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">expansion</span><span class="p">)</span>
<span class="c1"># [1, q0, q0^2]</span>
<span class="k">print</span><span class="p">(</span><span class="n">expansion</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
<span class="c1"># {(0,): array([1, 0, 0]),</span>
<span class="c1">#  (1,): array([0, 1, 0]),</span>
<span class="c1">#  (2,): array([0, 0, 1])}</span></pre><p>For certain problems, the coefficients become very sparse.</p><p>Implementing <tt>scipy.sparse</tt> allows for addressing such problems.</p></div><div class="step step-level-1" step="26" data-x="6000" data-y="-8000" data-rotate-x="0" data-rotate-y="0" data-rotate-z="270" data-scale="1" data-z="0"><h1 id="thanks-for-listening">Thanks for listening!</h1></div><div class="step step-level-1" step="27" data-scale="4" data-x="11000" data-y="-3000" data-rotate-x="0" data-rotate-y="0" data-rotate-z="90" data-z="0"><p>This presentation was made with Hovercraft.</p><pre class="highlight code rst"><span class="gh">Thanks for listening!</span>
<span class="gh">=====================</span>

----

<span class="nc">:data-rotate:</span> <span class="nf">90</span>
<span class="nc">:data-scale:</span> <span class="nf">4</span>
<span class="nc">:data-x:</span> <span class="nf">r5000</span>
<span class="nc">:data-y:</span> <span class="nf">r5000</span>

This presentation was made with Hovercraft.

<span class="p">..</span> <span class="ow">code</span><span class="p">::</span> rst

   &lt;-- recursion error! --&gt;</pre></div></div><div id="hovercraft-help"><table><tr><th>Space</th><td>Forward</td></tr><tr><th>Right, Down, Page Down</th><td>Next slide</td></tr><tr><th>Left, Up, Page Up</th><td>Previous slide</td></tr><tr><th>G</th><td>Go to slide number</td></tr><tr><th>P</th><td>Open presenter console</td></tr><tr><th>H</th><td>Toggle this help</td></tr></table></div><script type="text/javascript" src="js/impress.js"></script><script type="text/javascript" src="js/impressConsole.js"></script><script type="text/javascript" src="js/hovercraft.js"></script></body></html>